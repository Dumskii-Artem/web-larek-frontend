# Проектная работа "Веб-ларек"

Стек: HTML, SCSS, TS, Webpack

Структура проекта:
- src/ — много разных файлов
- src/components/ — здесь самое мясо! Компоненты!
- src/components/base/ — немного попользованное наследство

Важные файлы:
- src/pages/index.html — HTML-файл главной страницы
- src/types/index.ts — файл с типами
- src/index.ts — точка входа приложения
- src/scss/styles.scss — корневой файл стилей - мне подарили
- src/utils/constants.ts — файл с константами - там адреса
- src/utils/utils.ts — файл с утилитами - нашёл

## Установка и запуск
Для установки и запуска проекта необходимо выполнить команды

```
npm install
npm run start
```

или

```
yarn
yarn start
```
## Сборка

```
npm run build
```

или

```
yarn build
```


## Данные и типы данных, используемые в приложении

Ништяк, он же Item
```
export interface IItem {
    id: string;
    itemIndex: number;
    category: TItemCategory;
    description: string;
    image: string;
    price: number | null;
    title: string;
    in_basket: boolean;
}
```

Категория ништяков, они хитрым образом влияют на цвет плашки с названием категории
```
export type TItemCategory = 'софт-скил' | 'хард-скил' | 'другое' | 'кнопка' | 'дополнительное';

export const categoryType: Record<TItemCategory, string> = {
    'софт-скил': 'soft',
    'хард-скил': 'hard',
    'другое': 'other',
    'кнопка': 'button',
    'дополнительное': 'additional',
}
```

Витрина, здесь всё, что можно заказать и оплатить
```
export interface IShowcase {
    items: IItem[];
    getItem(itemId:string) : IItem;
}
```

Корзина
```
export interface IBasket {
    items : IItem[];
    addItem(item: IItem): void;
    alreadyInBasket(itemId: string) : boolean;
    clear(): void;
    getTotal(): number;
    getCount(): number;
    removeItem(itemId: string): void;
    checkTotal(value: number): boolean;
}
```

Заказ
```
export type TPaymentType = 'card' | 'cash' | null

export interface IOrderData {
    address: string;
    email: string;
    payment: TPaymentType;
    phone: string;
}
```
API
```
export type ApiPostMethods = 'POST' | 'PUT' | 'DELETE' | 'PATCH';

export interface IApi {
    baseUrl: string;
    get<T>(uri: string): Promise<T>;
    post<T>(uri: string, data: object, method?: ApiPostMethods): Promise<T>;
}
```
Ответ сервера на отправленный заказ
```
export interface IOrderResponse {
  id?: string;
  total?: number;
  error?: string;
  code?: number;
}
```


## Архитектура приложения

Код приложения разделен на слои согласно парадигме MVP: 
- слой представления, отвечает за отображение данных на странице, 
- слой данных, отвечает за хранение и изменение данных
- еще есть API, который посылает к серверу и получает от него
- обмен сообщениями между объектами происходит через эмиттер. все сообщения принимаются в файле src\index.ts

### Базовый код

#### Класс Api
Содержит в себе базовую логику отправки запросов. В конструктор передается базовый адрес сервера и опциональный объект с заголовками запросов.
Методы: 
- `get` - выполняет GET запрос на переданный в параметрах ендпоинт и возвращает промис с объектом, которым ответил сервер
- `post` - принимает объект с данными, которые будут переданы в JSON в теле запроса, и отправляет эти данные на ендпоинт переданный как параметр при вызове метода. По умолчанию выполняется `POST` запрос, но метод запроса может быть переопределен заданием третьего параметра при вызове.

#### Класс EventEmitter
Брокер событий позволяет отправлять события и подписываться на события, происходящие в системе. Класс используется в презентере для обработки событий и в слоях приложения для генерации событий.  
Основные методы, реализуемые классом описаны интерфейсом `IEvents`:
- `on` - подписка на событие
- `emit` - инициализация события

### Слой данных

#### Класс Showcase
Класс отвечает за хранение и логику работы с данными карточек представленных на витрине.

#### Класс Basket
Класс отвечает за хранение ништяков, попавших в корзину.\

#### Класс Order
Класс отвечает за хранение информации, необходимой для оформления заказов.\

### Слой представления
Все классы представления отвечают за отображение внутри контейнера (DOM-элемент) передаваемых в них данных.\

#### Класс Modal
Реализует модальное окно. Особенность в том, что в приложении только один экземпляр этого класса. и в нём отрисовываются различные два варианта форм и одна неформа.\
этот класс Так же предоставляет методы `open` и `close` для управления отображением модального окна. Устанавливает слушатели на клавиатуру, для закрытия модального окна по Esc, на клик в оверлей и кнопку-крестик для закрытия попапа.  
- constructor(selector: string, events: IEvents) Конструктор принимает селектор, по которому в разметке страницы будет идентифицировано модальное окно и экземпляр класса\
- `EventEmitter` для возможности инициации событий.


#### Класс FormView
Обобщённый класс формы. Отрисовывается внутри класса Modal./ 
Содержит кнопку Submit и элементы ввода Input. Генерирует сообщения при вводе информации пользователем

#### Класс SuccessView
Реализация содержимого окошка с результатом оформления заказа

#### Класс BasketView
Список карточек в корзине

#### Класс CardView
Обобщенный класс карточки товара. От него наследуются классы карточек
- CardBasket
- CardShowcase
- CardPreview

